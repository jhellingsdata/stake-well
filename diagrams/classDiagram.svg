<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 5.0.0 (20220707.1540)
 -->
<!-- Title: UmlClassDiagram Pages: 1 -->
<svg width="940pt" height="1533pt"
 viewBox="0.00 0.00 940.44 1533.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1529.4)">
<title>UmlClassDiagram</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1529.4 936.44,-1529.4 936.44,4 -4,4"/>
<!-- 1 -->
<g id="node1" class="node">
<title>1</title>
<polygon fill="#f2f2f2" stroke="black" points="380.66,-0.5 380.66,-100.5 551.78,-100.5 551.78,-0.5 380.66,-0.5"/>
<text text-anchor="middle" x="466.22" y="-83.9" font-family="Times,serif" font-size="14.00">&lt;&lt;Enum&gt;&gt;</text>
<text text-anchor="middle" x="466.22" y="-67.1" font-family="Times,serif" font-size="14.00">RaffleState</text>
<text text-anchor="middle" x="466.22" y="-50.3" font-family="Times,serif" font-size="14.00">contracts/src/RafflePool.sol</text>
<polyline fill="none" stroke="black" points="380.66,-42.1 551.78,-42.1 "/>
<text text-anchor="start" x="388.66" y="-25.5" font-family="Times,serif" font-size="14.00">OPEN: 0</text>
<text text-anchor="start" x="388.66" y="-8.7" font-family="Times,serif" font-size="14.00">CALCULATING: 1</text>
</g>
<!-- 0 -->
<g id="node3" class="node">
<title>0</title>
<polygon fill="#f2f2f2" stroke="black" points="0,-137.5 0,-1387.9 932.44,-1387.9 932.44,-137.5 0,-137.5"/>
<text text-anchor="middle" x="466.22" y="-1371.3" font-family="Times,serif" font-size="14.00">RafflePool</text>
<text text-anchor="middle" x="466.22" y="-1354.5" font-family="Times,serif" font-size="14.00">contracts/src/RafflePool.sol</text>
<polyline fill="none" stroke="black" points="0,-1346.3 932.44,-1346.3 "/>
<text text-anchor="start" x="8" y="-1329.7" font-family="Times,serif" font-size="14.00">Private:</text>
<text text-anchor="start" x="8" y="-1312.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_stETH: IERC20Permit</text>
<text text-anchor="start" x="8" y="-1296.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_vrfCoordinator: VRFCoordinatorV2Interface</text>
<text text-anchor="start" x="8" y="-1279.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;REQUEST_CONFIRMATIONS: uint16</text>
<text text-anchor="start" x="8" y="-1262.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_callbackGasLimit: uint32</text>
<text text-anchor="start" x="8" y="-1245.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_numWords: uint32</text>
<text text-anchor="start" x="8" y="-1228.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_subscriptionId: uint64</text>
<text text-anchor="start" x="8" y="-1212.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_gasLane: bytes32</text>
<text text-anchor="start" x="8" y="-1195.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;i_interval: uint256</text>
<text text-anchor="start" x="8" y="-1178.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_lastTimestamp: uint256</text>
<text text-anchor="start" x="8" y="-1161.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_totalUserDeposits: uint256</text>
<text text-anchor="start" x="8" y="-1144.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_stakingRewardsTotal: uint256</text>
<text text-anchor="start" x="8" y="-1128.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_platformFee: uint256</text>
<text text-anchor="start" x="8" y="-1111.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_platformFeeBalance: uint256</text>
<text text-anchor="start" x="8" y="-1094.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_recentWinner: address</text>
<text text-anchor="start" x="8" y="-1077.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_activeUsers: address[]</text>
<text text-anchor="start" x="8" y="-1060.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_tempActiveUsers: address[]</text>
<text text-anchor="start" x="8" y="-1044.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_userDeposit: mapping(address=&gt;uint256)</text>
<text text-anchor="start" x="8" y="-1027.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_userTwabs: mapping(address=&gt;BalanceLog[])</text>
<text text-anchor="start" x="8" y="-1010.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_totalDepositTwabs: BalanceLog[]</text>
<text text-anchor="start" x="8" y="-993.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;s_raffleState: RaffleState</text>
<polyline fill="none" stroke="black" points="0,-985.5 932.44,-985.5 "/>
<text text-anchor="start" x="8" y="-968.9" font-family="Times,serif" font-size="14.00">Internal:</text>
<text text-anchor="start" x="8" y="-952.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_addUser(userAddress: address)</text>
<text text-anchor="start" x="8" y="-935.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_addBalance(userAddress: address, amount: uint256)</text>
<text text-anchor="start" x="8" y="-918.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_subtractBalance(userAddress: address, amount: uint256)</text>
<text text-anchor="start" x="8" y="-901.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_updateBalanceLogs(userAddress: address)</text>
<text text-anchor="start" x="8" y="-884.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_adjustPlatformFee(newFee: uint256)</text>
<text text-anchor="start" x="8" y="-868.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;fulfillRandomWords(uint256, randomWords: uint256[])</text>
<text text-anchor="start" x="8" y="-145.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_calculateTwab(userAddress: address, s_startTime: uint256, s_endTime: uint256): uint256</text>
<text text-anchor="start" x="8" y="-851.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_findPrecedingTimestampIndex(twabs: BalanceLog[], _s_lastTimestamp: uint256): uint256</text>
<text text-anchor="start" x="8" y="-834.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_checkRaffleState()</text>
<text text-anchor="start" x="8" y="-817.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;_cleanupUsers()</text>
<text text-anchor="start" x="8" y="-800.9" font-family="Times,serif" font-size="14.00">External:</text>
<text text-anchor="start" x="8" y="-784.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;payable&gt;&gt; depositEth() &lt;&lt;moreThanZero&gt;&gt;</text>
<text text-anchor="start" x="8" y="-767.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;depositStEth(amount: uint256) &lt;&lt;moreThanZero&gt;&gt;</text>
<text text-anchor="start" x="8" y="-750.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;depositStEthWithPermit(amount: uint256, deadline: uint256, v: uint8, r: bytes32, s: bytes32) &lt;&lt;moreThanZero&gt;&gt;</text>
<text text-anchor="start" x="8" y="-733.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;withdrawStEth(amount: uint256) &lt;&lt;moreThanZero&gt;&gt;</text>
<text text-anchor="start" x="8" y="-716.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;performUpkeep(bytes)</text>
<text text-anchor="start" x="8" y="-700.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;withdrawPlatformFee() &lt;&lt;onlyOwner&gt;&gt;</text>
<text text-anchor="start" x="8" y="-683.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;adjustPlatformFee(newFee: uint256) &lt;&lt;onlyOwner&gt;&gt;</text>
<text text-anchor="start" x="8" y="-666.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;updateStakingRewards()</text>
<text text-anchor="start" x="8" y="-649.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getTotalBalance(): uint256</text>
<text text-anchor="start" x="8" y="-632.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getUserDeposit(user: address): uint256</text>
<text text-anchor="start" x="8" y="-616.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getTotalUserDeposits(): uint256</text>
<text text-anchor="start" x="8" y="-599.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getStakingRewardsTotal(): uint256</text>
<text text-anchor="start" x="8" y="-582.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getRaffleState(): RaffleState</text>
<text text-anchor="start" x="8" y="-565.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getActiveDepositorsCount(): uint256</text>
<text text-anchor="start" x="8" y="-548.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getRecentWinner(): address</text>
<text text-anchor="start" x="8" y="-532.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getLastTimestamp(): uint256</text>
<text text-anchor="start" x="8" y="-515.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getInterval(): uint256</text>
<text text-anchor="start" x="8" y="-498.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getPlatformFee(): uint256</text>
<text text-anchor="start" x="8" y="-481.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getPlatformFeeBalance(): uint256</text>
<text text-anchor="start" x="8" y="-464.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getLastUserBalanceLog(user: address): BalanceLog</text>
<text text-anchor="start" x="8" y="-448.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;getLastTotalBalanceLog(): BalanceLog</text>
<text text-anchor="start" x="8" y="-380.9" font-family="Times,serif" font-size="14.00">Public:</text>
<text text-anchor="start" x="8" y="-364.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; MintAndDepositSuccessful(depositor: address, amount: uint256, newBalance: uint256)</text>
<text text-anchor="start" x="8" y="-347.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; DepositSuccessful(depositor: address, amount: uint256, newBalance: uint256)</text>
<text text-anchor="start" x="8" y="-330.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; WithdrawSuccessful(withdrawer: address, amount: uint256, newBalance: uint256)</text>
<text text-anchor="start" x="8" y="-313.7" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; PickedWinner(winner: address, amount: uint256)</text>
<text text-anchor="start" x="8" y="-296.9" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; StakingRewardsUpdated(newRewardsTotal: uint256)</text>
<text text-anchor="start" x="8" y="-280.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; ProtocolFeeWithdrawn(amount: uint256)</text>
<text text-anchor="start" x="8" y="-263.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; ProtocolFeeAdjusted(newFee: uint256)</text>
<text text-anchor="start" x="8" y="-196.1" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;&lt;&lt;modifier&gt;&gt; moreThanZero(amount: uint256)</text>
<text text-anchor="start" x="8" y="-179.3" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;constructor(steth: address, interval: uint256, vrfCoordinatorV2: address, gasLane: bytes32, subscriptionId: uint64, callbackGasLimit: uint32, numWords: uint32)</text>
<text text-anchor="start" x="8" y="-162.5" font-family="Times,serif" font-size="14.00"> &#160;&#160;&#160;checkUpkeep(bytes): (upkeepNeeded: bool, bytes)</text>
</g>
<!-- 1&#45;&gt;0 -->
<g id="edge1" class="edge">
<title>1&#45;&gt;0</title>
<path fill="none" stroke="black" d="M462.58,-100.6C462.34,-108.13 462.11,-116.4 461.9,-125.34"/>
<polygon fill="black" stroke="black" points="461.9,-125.46 465.76,-131.55 461.63,-137.46 457.76,-131.37 461.9,-125.46"/>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<polygon fill="#f2f2f2" stroke="black" points="380.66,-1424.9 380.66,-1524.9 551.78,-1524.9 551.78,-1424.9 380.66,-1424.9"/>
<text text-anchor="middle" x="466.22" y="-1508.3" font-family="Times,serif" font-size="14.00">&lt;&lt;Struct&gt;&gt;</text>
<text text-anchor="middle" x="466.22" y="-1491.5" font-family="Times,serif" font-size="14.00">BalanceLog</text>
<text text-anchor="middle" x="466.22" y="-1474.7" font-family="Times,serif" font-size="14.00">contracts/src/RafflePool.sol</text>
<polyline fill="none" stroke="black" points="380.66,-1466.5 551.78,-1466.5 "/>
<text text-anchor="start" x="388.66" y="-1449.9" font-family="Times,serif" font-size="14.00">balance: uint256</text>
<text text-anchor="start" x="388.66" y="-1433.1" font-family="Times,serif" font-size="14.00">timestamp: uint256</text>
</g>
<!-- 2&#45;&gt;0 -->
<g id="edge2" class="edge">
<title>2&#45;&gt;0</title>
<path fill="none" stroke="black" d="M469.87,-1424.66C470.1,-1417.29 470.32,-1409.21 470.53,-1400.5"/>
<polygon fill="black" stroke="black" points="470.53,-1400.23 466.67,-1394.14 470.8,-1388.23 474.67,-1394.32 470.53,-1400.23"/>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge4" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="black" d="M470.81,-137.46C470.61,-127.86 470.39,-118.89 470.16,-110.64"/>
<polygon fill="black" stroke="black" points="473.66,-110.49 469.86,-100.6 466.66,-110.7 473.66,-110.49"/>
</g>
<!-- 0&#45;&gt;2 -->
<g id="edge3" class="edge">
<title>0&#45;&gt;2</title>
<path fill="none" stroke="black" d="M461.64,-1388.23C461.83,-1397.61 462.05,-1406.37 462.27,-1414.45"/>
<polygon fill="black" stroke="black" points="458.78,-1414.76 462.57,-1424.66 465.78,-1414.56 458.78,-1414.76"/>
</g>
</g>
</svg>
